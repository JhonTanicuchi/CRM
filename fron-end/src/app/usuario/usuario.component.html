<div class="grid grid-cols-5 divide-x divide-black-100">
  <div class="p-2 relative bg-white" style="height:calc(100vh - 64px - 40px)">
   <div>
      <div class="shadow stats w-full mb-2 rounded-lg bg-gray-100">
        <div class="stat">
          <div class="stat-figure  text-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
          </div>
          <div class="stat-value">{{UsuariosActivos()}}</div>
          <div class="stat-title">Activos</div>
          <div class="stat-desc text-secondary">{{listadoUsuarios.length-UsuariosActivos()}} Desconectados</div>
        </div>
      </div>

      <div class="shadow stats w-full mb-2 rounded-lg bg-gray-100">
        <div class="stat">
          <div class="stat-figure text-primary">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
          </div>
          <div class="stat-title">Usuarios Totales</div>
          <div class="stat-value">{{listadoUsuarios.length}}</div>
          <div class="stat-desc">Usuarios registrados</div>
        </div>
      </div>

      <div class="shadow stats w-full mb-2 rounded-lg bg-gray-100">
        <div class="stat">
          <div class="stat-figure text-primary">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
            </svg>
          </div>
          <div class="stat-title">Empleados</div>
          <div class="stat-value">0</div>
          <div class="stat-desc">Empleados registrados</div>
        </div>
      </div>
   </div>

    <button [ngClass]="{'hidden': flag, 'flex': !flag}" (click)="cambiarFlag()" (click)="limpiarForm()" (click)="iconDeletFalse()" class="btn bg-primary border-primary text-white absolute right-0 bottom-0 m-2 btn-circle hover:bg-primary-focus hover:border-primary-focus">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
      </svg>
    </button>
  </div>

  <div [ngClass]="{'hidden': flag, 'block': !flag}" class="col-start-2 col-end-6 overflow-auto scrollbar-hide p-2 relative" style="height:calc(100vh - 64px - 40px)">
    <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8 ">
      <div class="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
        <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-100">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Empleado</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Area</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Usuario</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rol</th>
                <th scope="col" class="relative px-6 py-3">
                  <span class="sr-only">Editar</span>
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let usuario of listadoUsuarios"
              [class.active]="usuario==usuarioActual">
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="avatar">
                      <div class="w-12 mask mask-squircle">
                        <img src="https://api.lorem.space/image/face?hash=47449">
                      </div>
                    </div>
                    <div  class="ml-4">
                      <div  class="text-sm font-medium text-gray-900">Nombre Apellido {{usuario.personaId}}</div>
                      <div class="text-sm text-gray-500">correo.nombre@example.com</div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm text-gray-900">Inbound</div>
                  <div class="text-sm text-gray-500">Retenciones</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{usuario.username}}</td>
                <td *ngIf="usuario.estado==true" class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"> Activo </span>
                </td>
                <td *ngIf="usuario.estado==false" class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"> Inactivo </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Admin</td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <a (click)="seleccionarUsuario(usuario)" (click)="cambiarFlag()" (click)="iconDeletTrue()" (click)="buscarPersona(usuarioActual.personaId)"class="text-primary hover:text-primary-focus cursor-pointer">Editar</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
      <p *ngIf="listadoUsuarios.length==0" class="text-gray-400">No hay usuarios</p>
    </div>
  </div>

  <div [ngClass]="{'block': flag, 'hidden': !flag}" class="col-start-2 col-end-6 p-2 relative">

    <div *ngIf="usuarioActual.personaId>0" class="bg-gray-100 rounded-lg">
      <div class="max-h-10 mx-auto py-16 px-4 sm:px-4 lg:py-16 lg:px-4 lg:flex lg:items-center lg:justify-between">
        <div class="flex items-center">
          <div class="avatar">
            <div class="w-24 mask mask-squircle">
              <img src="https://api.lorem.space/image/face?hash=47449">
            </div>
          </div>
          <h2 class="text-3xl ml-5 font-extrabold tracking-tight text-gray-900 sm:text-4xl">
            <span class="block text-xl uppercase font-bold text-gray-900">{{personaDatos.nombre}} {{personaDatos.apellido}}<input [(ngModel)]="usuarioActual.estado" type="checkbox" checked="checked" class="checkbox checkbox-xs checkbox-primary ml-2"> </span>
            <span class="block text-sm font-medium text-gray-500">{{personaDatos.cedula}}</span>
            <span class="block text-sm font-light text-gray-500">{{personaDatos.correo}}</span>
          </h2>
        </div>
      <button (click)="limpiarPersona()" class="btn text-white btn-sm text-xs">Editar</button>
      </div>
    </div>

    <div *ngIf="usuarioActual.personaId==0" class="bg-gray-100 rounded-lg">
      <div class="max-h-10 mx-auto py-16 px-4 sm:px-4 lg:py-16 lg:px-4 lg:flex lg:items-center lg:justify-between">
        <div class="flex items-center">
          <div>
            <label for="empleado" class="block text-sm font-medium text-gray-700">Empleado</label>
            <div class="mt-1 relative rounded-md shadow-sm">
              <select [(ngModel)]="usuarioActual.personaId" (change)="buscarPersona(usuarioActual.personaId)"  class=" w-full max-w-xs focus:ring-secondary focus:border-secondary block sm:text-sm border-primary rounded-md">
                <option disabled selected>Empleado</option>
                <option *ngFor="let persona of personas | async" [value]="persona.personaId" value="{{persona.personaId}}" >{{persona.nombre}} {{persona.apellido}}</option>
              </select>
            </div>
          </div>
        </div>

      </div>
    </div>


    <div class="p-5 pt-10 grid grid-cols-3 gap-4 gap-x-5 gap-y-5">
      <div>
        <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
        <div class="mt-1 relative rounded-md shadow-sm">
          <input type="text" name="username" id="username" class=" focus:ring-secondary focus:border-secondary block w-full sm:text-sm border-primary rounded-md" [(ngModel)]="usuarioActual.username" placeholder="username">
        </div>
      </div>

      <div>
        <label for="password" class="block text-sm font-medium text-gray-700">Contraseña</label>
        <div class="mt-1 relative rounded-md shadow-sm">
          <input type="text" name="password" id="password" class="focus:ring-secondary focus:border-secondary block w-full sm:text-sm border-primary rounded-md" [(ngModel)]="usuarioActual.password" placeholder="contraseña">
        </div>
      </div>

      <div>
        <label for="rol" class="block text-sm font-medium text-gray-700">Rol</label>
        <div class="mt-1 relative shadow-sm">
          <select [(ngModel)]="usuarioActual.rolId" id="rol" class=" w-full  focus:ring-secondary focus:border-secondary block sm:text-sm border-primary rounded-md">
            <option disabled selected>Rol</option>
            <option *ngFor="let rol of roles | async;" value="{{rol.rolId}}" >{{rol.nombreRol}}</option>
          </select>
        </div>
      </div>

    </div>

    <div class="w-full p-5 pt-5">
      <div class="flex justify-between items-center">
        <h1 class="font-medium">Permisos</h1>
        <button class="btn bg-white border-white text-primary btn-circle hover:bg-white hover:border-white hover:text-primary-focus ">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
          </svg>
        </button>
      </div>
      <div class="w-full h-48 p-2  rounded-lg border border-primary">
        <button *ngFor="let permiso of permisos | async" class="m-2 btn btn-xs">
          <span class="mr-2">{{permiso.nombrePermiso}}</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hover:text-error-content" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </button>

        <div class="flex justify-center items-center w-full h-full">
          <p *ngIf="usuarioActual.rolId == 0" class="text-gray-400">No hay permisos</p>
        </div>

      </div>
    </div>

    <div class="card-actions mb-5 mx-3 absolute bottom-0 flex justify-between" style="width: calc(100% - 1rem - 0.75rem - 0.75rem);">
        <button (click)="cambiarFlag()" class="btn bg-white text-neutral border-white btn-circle hover:bg-neutral hover:border-neutral hover:text-white">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
          </svg>
        </button>

        <button (click)="cambiarFlag()" (click)="save(usuarioActual)" class="btn bg-primary border-primary text-white  hover:bg-primary-focus hover:border-primary-focus">
          <span class="mr-2">Guardar</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
          </svg>
        </button>

        <button *ngIf="iconDelete==true" (click)="cambiarFlag()" (click)="deleteById(usuarioActual.usuarioId)" class="btn bg-white border-white text-error-content btn-circle hover:bg-error-content hover:border-error-content hover:text-white ">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
          </svg>
        </button>
    </div>
  </div>

</div>
